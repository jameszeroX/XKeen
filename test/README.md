## Версия 1.1.3.9 Beta

> [!NOTE]
> Это версия из канала разработки. Она регулярно дорабатывается, содержит новейшие функции, возможности и исправления, но может иметь не выявленные ошибки. Если столкнулись с проблемой - обязательно обновитесь командой `xkeen -uk`, возможно ошибка уже известна и исправлена. Если же проблема сохранилась, выполните `xkeen -diag` и покажите диагностический отчёт в телеграм-чате https://t.me/+8Cvh7oVf6cE0MWRi, подробно описав возникшую проблему

> [!CAUTION]
> Так как разработчики KeeneticOS не прислушались к пользователям и в 5 версии прошивки сделали протокол IPv6 не удаляемым (а это в некоторых случаях приводит к проблемам проксирования), в XKeen реализован альтернативный способ удаления поддержки IPv6. Важно учитывать, что при этом, IPv6 будет полностью отключен для трафика на роутере, некоторые функции Keenetic могут работать некорректно. Это экспериментальная функция, используйте её только в крайнем случае. Отключение IPv6 средствами XKeen обратимо, предусмотрена возможность включить его, если что-то пойдет не так

### Изменения
- Добавлена совместимость с прошивкой KeeneticOS 5+
- Добавлена возможность отключить/включить протокол IPv6 в KeeneticOS (параметр запуска `-ipv6`)
- При обновлении Xray и Mihomo теперь отображается версия уже установленного в роутере бинарника
- Исправлено добавление диапазона портов в исключения проксирования
- Снято техническое ограничение, позволявшее использовать не более 15 портов проксирования и портов исключенных из проксирования
- Более корректный парсинг dns-настроек Xray и Mihomo
- Добавлена возможность отключить/включить перехват DNS запросов при соответствующей настройке прокси-клиента (параметр запуска `-dns`)
- Доработан механизм загрузки геофайлов из интернета
- Исправлен сбой автозапуска XKeen, возникавший в некоторых случаях
- Скрипт запуска S24xray переименован в S99xkeen, вспомогательный скрипт S99xkeenstart упразднён
- Добавлена поддержка внешних файлов `ip_exclude.lst`, `port_proxying.lst` и `port_exclude.lst` в директории `/opt/etc/xkeen/` для указания IP и портов (проксирования/исключения из проксирования)
- Добавлена возможность загружать компоненты XKeen через [Self-Hosted прокси](https://github.com/hunshcn/gh-proxy) при недоступности GitHub (переменные `gh_proxy(1|2)` в файле `01_info_variable.sh`)
- Добавлена возможность отключить резервное копирование XKeen при обновлении (переменная `backup` в файле `S99xkeen`)

### Порядок обновления с версии 1.1.3.8
Переключитесь на канал разработки
```
xkeen -channel
```
и выполните обновление c локальной переустановкой:
```
xkeen -uk
xkeen -k
```
В канале разработки команда `xkeen -uk` при каждом запуске загружает и устанавливает актуальную бету XKeen

### Порядок установки
```
opkg update && opkg upgrade && opkg install curl tar && cd /tmp
curl -OL --connect-timeout 10 -m 60 https://raw.githubusercontent.com/jameszeroX/xkeen/main/test/xkeen.tar.gz
tar -xvzf xkeen.tar.gz -C /opt/sbin > /dev/null && rm xkeen.tar.gz
xkeen -i
```
